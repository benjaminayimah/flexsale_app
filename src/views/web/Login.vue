<template>
  <section id="login_page">
      <div class="container-fluid">
          <div class="container">
              <div class="login-wrapper">
                  <header>
                      <svg xmlns="http://www.w3.org/2000/svg" width="197.728" height="34.823" viewBox="0 0 197.728 34.823">
                        <path id="Path_1645" data-name="Path 1645" d="M-56.792-596.556l-.024-.025,11.839-11.838a6.081,6.081,0,0,0,1.793-4.329,6.081,6.081,0,0,0-1.793-4.328l-13.347-13.347h6.33a3.267,3.267,0,0,1,2.308.956l10.659,10.758c3.505,3.823,2.488,9.8-.171,12.157l-9.959,10c-.638.637-2.228.956-3.817.956S-56.154-595.919-56.792-596.556Zm-9.711-.61-14.11-14.094a1.509,1.509,0,0,1-.443-1.067v-16.428a1.508,1.508,0,0,1,1.508-1.508H-63.12a1.51,1.51,0,0,1,1.067.441l14.11,14.112,0,0a4.763,4.763,0,0,1,1.394,3.38,4.764,4.764,0,0,1-1.394,3.38l0,0-11.778,11.778a4.759,4.759,0,0,1-3.391,1.406A4.761,4.761,0,0,1-66.5-597.166Zm-11.536-15.786L-64.37-599.3a1.763,1.763,0,0,0,1.257.523,1.764,1.764,0,0,0,1.258-.522l11.777-11.776a1.779,1.779,0,0,0,0-2.5l-13.666-13.667H-78.039Zm179.193,13.333a10.894,10.894,0,0,1-3.753-3.95,10.964,10.964,0,0,1-1.4-5.485,11.162,11.162,0,0,1,.809-4.261,11.174,11.174,0,0,1,2.228-3.484,10.373,10.373,0,0,1,3.307-2.354,9.692,9.692,0,0,1,4.023-.85,9.783,9.783,0,0,1,4.3.943,9.917,9.917,0,0,1,3.359,2.623,11.264,11.264,0,0,1,2.094,3.9,12.642,12.642,0,0,1,.508,4.748H99.713a7.521,7.521,0,0,0,1.161,3.141,6.792,6.792,0,0,0,2.333,2.188,6.434,6.434,0,0,0,3.163.829,6.16,6.16,0,0,0,3.38-.964,7.232,7.232,0,0,0,2.447-2.643l3.545.829a10.849,10.849,0,0,1-3.753,4.51,9.585,9.585,0,0,1-5.619,1.752A9.643,9.643,0,0,1,101.154-599.619Zm2.022-16.422a7.148,7.148,0,0,0-2.395,2.291,7.552,7.552,0,0,0-1.172,3.225h13.519a6.854,6.854,0,0,0-1.12-3.183,7.387,7.387,0,0,0-2.426-2.312,6.2,6.2,0,0,0-3.214-.87A6.207,6.207,0,0,0,103.176-616.041Zm-34.71,17.034a11.216,11.216,0,0,1-3.514-2.385,11.061,11.061,0,0,1-2.374-3.514,10.806,10.806,0,0,1-.85-4.292,10.674,10.674,0,0,1,.83-4.189,10.7,10.7,0,0,1,2.311-3.452,10.931,10.931,0,0,1,3.432-2.322,10.423,10.423,0,0,1,4.168-.84,8.031,8.031,0,0,1,4.324,1.151,9.007,9.007,0,0,1,2.975,2.975l-.124-3.546h3.483v20.735h-3.5l-.125-3.5a7.974,7.974,0,0,1-2.685,2.924,7.238,7.238,0,0,1-4.054,1.12A10.7,10.7,0,0,1,68.466-599.007Zm.269-16.557a7.292,7.292,0,0,0-2.623,2.778,7.383,7.383,0,0,0-.86,3.878,7.592,7.592,0,0,0,1.161,3.732,7.915,7.915,0,0,0,2.747,2.664,7.178,7.178,0,0,0,3.681.985,6.1,6.1,0,0,0,3.567-1.036,6.569,6.569,0,0,0,2.27-2.779,8.509,8.509,0,0,0,.695-3.857,8.619,8.619,0,0,0-.975-3.753,7.055,7.055,0,0,0-2.4-2.664,6.315,6.315,0,0,0-3.525-.986A6.965,6.965,0,0,0,68.735-615.564ZM4.923-599.619a10.894,10.894,0,0,1-3.753-3.95,10.955,10.955,0,0,1-1.4-5.485,11.162,11.162,0,0,1,.809-4.261A11.174,11.174,0,0,1,2.808-616.8a10.373,10.373,0,0,1,3.307-2.354,9.691,9.691,0,0,1,4.022-.85,9.784,9.784,0,0,1,4.3.943,9.926,9.926,0,0,1,3.359,2.623,11.264,11.264,0,0,1,2.094,3.9,12.642,12.642,0,0,1,.508,4.748H3.482a7.509,7.509,0,0,0,1.161,3.141,6.792,6.792,0,0,0,2.333,2.188,6.433,6.433,0,0,0,3.162.829,6.161,6.161,0,0,0,3.38-.964,7.222,7.222,0,0,0,2.446-2.643l3.546.829a10.862,10.862,0,0,1-3.753,4.51,9.586,9.586,0,0,1-5.62,1.752A9.642,9.642,0,0,1,4.923-599.619Zm2.022-16.422A7.149,7.149,0,0,0,4.55-613.75a7.552,7.552,0,0,0-1.172,3.225H16.9a6.854,6.854,0,0,0-1.12-3.183,7.387,7.387,0,0,0-2.425-2.312,6.2,6.2,0,0,0-3.215-.87A6.206,6.206,0,0,0,6.945-616.041Zm44.227,17.749a10.782,10.782,0,0,1-3.265-.632,9.246,9.246,0,0,1-2.779-1.555A5.894,5.894,0,0,1,43.4-602.75l2.985-1.285a3.516,3.516,0,0,0,1.12,1.327,6.673,6.673,0,0,0,1.867,1,6.363,6.363,0,0,0,2.136.373,6.351,6.351,0,0,0,2.136-.353,3.926,3.926,0,0,0,1.627-1.047,2.392,2.392,0,0,0,.633-1.669,2.023,2.023,0,0,0-.695-1.628,5.091,5.091,0,0,0-1.742-.932q-1.048-.343-2.125-.653a22.977,22.977,0,0,1-3.816-1.3,7.143,7.143,0,0,1-2.643-1.929,4.558,4.558,0,0,1-.964-3,5.372,5.372,0,0,1,1.067-3.338,6.975,6.975,0,0,1,2.81-2.177,9.157,9.157,0,0,1,3.732-.767,9.781,9.781,0,0,1,4.583,1.078,7.2,7.2,0,0,1,3.089,2.923l-2.8,1.638a3.662,3.662,0,0,0-1.078-1.317,5.833,5.833,0,0,0-1.659-.9,6.054,6.054,0,0,0-1.908-.353,6.33,6.33,0,0,0-2.249.311,3.808,3.808,0,0,0-1.679,1.067,2.579,2.579,0,0,0-.633,1.773,1.9,1.9,0,0,0,.674,1.576,5.105,5.105,0,0,0,1.762.86q1.088.321,2.374.736a27.1,27.1,0,0,1,3.524,1.39,7.9,7.9,0,0,1,2.644,1.969,4.272,4.272,0,0,1,.985,2.924,5.156,5.156,0,0,1-1.14,3.328,7.243,7.243,0,0,1-2.955,2.166,9.037,9.037,0,0,1-3.473.672Q51.381-598.284,51.172-598.292Zm37.282-.393v-28.841h3.463v28.841Zm-51.692,0-5.432-7.465-5.453,7.465H19.322l7.589-10.409-7.547-10.367h6.554l5.412,7.382,5.391-7.382h6.555l-7.548,10.367,7.59,10.409Zm-44.538,0v-28.841h3.462v28.841Zm-20.279,0v-29.029h17.024v3.484h-13.54v8.252h11.549v3.484H-24.572v13.81Zm-46.21-19.654a4.827,4.827,0,0,1,4.2-5.379,4.826,4.826,0,0,1,5.38,4.2,4.828,4.828,0,0,1-4.2,5.379,4.931,4.931,0,0,1-.595.036A4.827,4.827,0,0,1-74.265-618.34Zm4.478-3.135a2.567,2.567,0,0,0-2.233,2.858,2.569,2.569,0,0,0,2.858,2.235,2.568,2.568,0,0,0,2.234-2.859,2.569,2.569,0,0,0-2.544-2.254A2.49,2.49,0,0,0-69.788-621.474Z" transform="translate(81.056 630.423)" fill="#fff"/>
                    </svg>
                  </header>
                  
                  <div id="login_card">
                        <h1>Welcome back!</h1>
                        <div v-if="validation.error" class="validation-error">
                          <span>{{ validation.message }}</span>
                        </div>
                    <form action="">
                      <div class="form-row">
                          <label>Email:</label>
                          <input v-model="form.email" @mousedown="resertForm" type="email" name="email" class="form-control">
                      </div>
                      <div class="form-row">
                          <label>Password:</label>
                          <input v-model="form.password" @mousedown="resertForm" type="password" name="password" class="form-control">
                      </div>
                        <button class="button button-primary" @click.prevent="submitSignin">Login</button>
                      <p>
                        <router-link id="go_hm" :to="{ name: 'Home' }">Back Home</router-link>
                    </p>
                  </form>
                  </div>
              </div>
          </div>
      </div>
  </section>
</template>

<script>
//import { mapActions } from 'vuex'
import { mapGetters } from 'vuex'
import axios from 'axios'

export default {
    name: 'Login',
    computed: mapGetters(['getHostname']),
    data() {
        return {
            form: {
              email: 'benjaminayimah@gmail.com',
              password: 'ajf1432#@!'
            },
            validation: {
                error: false,
                message: 'sdfd'
            }
        }
    },
    methods: {
        submitSignin() {
            this.resertForm()
            axios.post(this.getHostname+'/api/sign-in', this.form)
            .then((res) => {
                this.$store.commit('setAuthToken', res.data.token)
                localStorage.setItem('token', res.data.token)
                location.reload()
            }).catch((err) => {
                if (err.response.status == 401) {
                    this.validation.error = true
                    this.validation.message = 'Wrong password'
                }

            })
        },
        resertForm() {
            if (this.validation.error === true)
            this.validation.error = false
            this.validation.message = null
            return
        }
    }
}
</script>
<style scoped lang="scss">
header{
    text-align: center;
    margin-bottom: 40px;
}

#login_page{
    background-color: $primary-color;
    display: flex;
    justify-content: center;
    flex-direction: column;
    height: 100vh;
    background-image: url('../../assets/images/shapes.svg');
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
}
p{
    margin-bottom: 0;
    text-align: center;
    & a{
    color: $dark;
    }
}

.login-wrapper{
    width: 35%;
    min-width: 350px;
    margin: 0 auto;
}
#login_card{
    padding: 60px  40px;
    background-color: $white-color;
    border-radius: 1rem;
}

button{
    width: 100%;
}
h1{
    margin: 0 0 25px 0;
    font-weight: 700;
    text-align: center;
}
.validation-error {
    padding: 15px;
    border-radius: 6px;
    background-color: rgba(230, 50, 50, 0.1);
    border: 1px solid rgba(230, 50, 50, 0.5);
    color: #9E2323;
    margin-bottom: 20px;
    & span{
        font-size: 0.9rem;
    }
}
</style>